name: "Try environments and artifacts"

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Environment to run tests against'
        type: environment
        required: true
  
jobs:
  tag:
    name: "Set tag output"
    runs-on: [ self-hosted, azure ]
    steps:
      - name: Set output
        run: echo "TAG=${GITHUB_SHA:0:8}" >> $GITHUB_OUTPUT

  artifacts:
    needs: [tag]
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    steps:
      - uses: hmarr/debug-action@v2
      - run: |
          echo "${{ needs.tag.outputs.TAG }}"
#       - uses: actions/upload-artifact@v3
#         with:
#           name: "tfplan"
#           path: test/file.txt
#           retention-days: 3
#       - run: rm -rf test/
#       - uses: actions/download-artifact@v3
#         with:
#           name: "tfplan"
#           path: test
#       - run: cat test/file.txt
